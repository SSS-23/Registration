<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WDES 2024</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f2f2f2;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 10px; /* 添加边距以避免内容贴边 */
        }
        h1 {
            color: #333;
            margin-bottom: 20px;
            text-align: center; /* 确保标题在小屏幕上居中 */
        }
        input[type="text"] {
            padding: 10px;
            font-size: 16px;
            border: 2px solid #ccc;
            border-radius: 5px;
            width: 100%; /* 适配不同屏幕 */
            max-width: 400px; /* 设置最大宽度 */
            margin-bottom: 10px;
            box-sizing: border-box; /* 确保内边距和边框不超出宽度 */
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            color: #fff;
            background-color: #007BFF;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
            width: 100%; /* 适配不同屏幕 */
            max-width: 200px; /* 设置最大宽度 */
        }
        button:hover {
            background-color: #0056b3;
        }
        p {
            margin-top: 20px;
            font-size: 16px;
            color: #333;
            white-space: pre-line;
            text-align: center;
            padding: 0 10px; /* 添加左右内边距 */
        }

        /* 媒体查询: 适配小屏幕 */
        @media (max-width: 600px) {
            h1 {
                font-size: 24px; /* 减小标题大小 */
            }
            input[type="text"] {
                font-size: 14px; /* 减小字体大小 */
            }
            button {
                font-size: 14px; /* 减小按钮字体大小 */
            }
            p {
                font-size: 14px; /* 减小结果文本大小 */
            }
        }
    </style>
</head>
<body>
    <h1>Welcome</h1>
    <input type="text" id="nameInput" placeholder="Please Enter Your Name:">
    <button onclick="findSeat()">查询</button>
    <p id="result"></p>

    <script>
        async function fetchSheetData(sheetId, range) {
            const apiKey = 'AIzaSyAcVANPtUFAblaSd7l-4dUSRsfvQAHK1NE'; // 替换为你的 API Key
            const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`);
            const data = await response.json();
            return data.values;
        }

        async function findSeat() {
            const name = document.getElementById('nameInput').value.trim();

            // 替换为你的 Google Sheets ID 和范围
            const sheetId = '15PUAZoOP_wcnr2DoxgdDzz54B8kAeSj0RhC3Xn615vg';
            const sheet1Range = 'PRINT!A:B'; // 第一张表的范围
            const sheet2Range = 'FULL!A:A'; // 第二张表的范围

            const sheet1Data = await fetchSheetData(sheetId, sheet1Range);
            const sheet2Data = await fetchSheetData(sheetId, sheet2Range);

            // 查找第一张表中的姓名
            const matchInSheet1 = sheet1Data.find(row => row[0] === name);
            if (matchInSheet1) {
                document.getElementById('result').innerText = `Thank you for checking in. Please make your way to table number ${matchInSheet1[1]}`;
                return;
            }

            // 查找第二张表中的姓名
            const matchInSheet2 = sheet2Data.find(row => row[0] === name);
            if (matchInSheet2) {
                document.getElementById('result').innerText = 'Thank you for checking in. Please feel free to take a seat at any available table.';
                return;
            }

            // 如果两张表中都未找到
            document.getElementById('result').innerHTML = 'We seem to be having trouble locating your registration.<br>Do not worry. <br>Just try again.<br>Kindly double check that the name you entered matches the one you used when you registered, paying close attention to capitalization.<br><br><br>If you are still having trouble, please feel free to take a seat at any available table and let our staff know. Thank you for your patience!';
        }
    </script>
</body>
</html>

